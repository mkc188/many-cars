!function(){"use strict";function t(){}t.prototype={preload:function(){this.load.image("preloader","assets/preloader.gif")},create:function(){this.game.input.maxPointers=1,this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.maxWidth=1280,this.game.scale.maxHeight=720,this.game.scale.forceOrientation(!0),this.game.scale.pageAlignHorizontally=!0,this.game.scale.setScreenSize(!0),this.game.state.start("preloader")}},window["drift-runners"]=window["drift-runners"]||{},window["drift-runners"].Boot=t}(),function(){"use strict";function t(){this.buttonUp=null,this.buttonDown=null,this.buttonLeft=null,this.buttonRight=null,this.rectWidth=100,this.rectHeight=50}t.prototype={init:function(){this.game.renderer.renderSession.roundPixels=!0},preload:function(){this.game.load.spritesheet("button","assets/arrow_button_spritesheet.png",114,94)},create:function(){var t=this.game.width/2,i=this.game.height/2;this.buttonUp=this.game.add.button(t,i,"button",this.buttonUpOnClick,this,2,1,0),this.buttonUp.anchor.set(.5),this.buttonUp.x=t-this.buttonUp.width,this.buttonUp.y=i-this.buttonUp.height/1.5,this.buttonUp.angle=90,this.buttonDown=this.game.add.button(t,i,"button",this.buttonDownOnClick,this,2,1,0),this.buttonDown.anchor.set(.5),this.buttonDown.x=this.buttonUp.x-3,this.buttonDown.y=i+this.buttonDown.height/1.5,this.buttonDown.angle=270,this.buttonLeft=this.game.add.button(t,i,"button",this.buttonLeftOnClick,this,2,1,0),this.buttonLeft.anchor.set(.5),this.buttonLeft.x=t+this.buttonLeft.width/3,this.buttonRight=this.game.add.button(t,this.buttonLeft.y,"button",this.buttonRightOnClick,this,2,1,0),this.buttonRight.anchor.set(.5),this.buttonRight.x=this.buttonLeft.x+1.1*this.buttonRight.width,this.buttonRight.scale.x=-1},update:function(){},onDown:function(){this.game.state.start("room")},buttonUpOnClick:function(){},buttonDownOnClick:function(){},buttonLeftOnClick:function(){},buttonRightOnClick:function(){}},window["drift-runners"]=window["drift-runners"]||{},window["drift-runners"].Control=t}(),function(){"use strict";function t(){this.player=null,this.steeringAngle=270,this.steeringMultiplier=2,this.currentSpeed=0,this.baseSpeed=0,this.backwardSpeed=0,this.skiddingSpeed=0,this.drifting=!1,this.reduceSpeed=!1}t.prototype={hitTrack:function(t,i){this.currentSpeed-=50},velocityFromAngle:function(t,i,e){return e=e||new Phaser.Point,e.x=Math.cos(this.game.math.degToRad(t))*i,e.y=Math.sin(this.game.math.degToRad(t))*i,e},click:function(t){var i,e=this.game.physics.p2.hitTest(t.position,[this.track1aL,this.track1aR,this.track1bL,this.track1bR]);if(0===e.length)i="You didn't click a Body";else{i="You clicked: ";for(var s=0;s<e.length;s++)i+=e[s].parent.sprite.key,s<e.length-1&&(i+=", ")}console.log(i)},create:function(){var t=this.game.width/2,i=this.game.height/2;this.game.physics.startSystem(Phaser.Physics.P2JS),this.game.physics.p2.setImpactEvents(!0),this.game.physics.p2.gravity.y=0,this.game.physics.p2.gravity.x=0;var e=this.game.physics.p2.createCollisionGroup(),s=this.game.physics.p2.createCollisionGroup();this.game.physics.p2.updateBoundsCollisionGroup(),this.track1=this.add.sprite(480,270,"track1"),this.game.physics.p2.enable([this.track1]),this.track1.body["static"]=!0,this.track1.body.clearShapes(),this.track1.body.loadPolygon("physicsData","track1"),this.car=this.add.sprite(t,i,"cars"),this.car.anchor.set(.5),this.car.frame=0,this.game.physics.p2.enable(this.car),this.car.body.setCircle(10),this.car.body.data.gravityScale=0,this.car.body.damping=.01;var n=this.game.physics.p2.createMaterial("carMaterial"),r=this.game.physics.p2.createMaterial("trackMaterial");this.car.body.setMaterial(n),this.car.body.fixedRotation=!0,this.track1.body.setMaterial(r);var h=this.game.physics.p2.createContactMaterial(n,r);h.friction=.3,h.restitution=0,h.stiffness=1e7,h.relaxation=3,h.frictionStiffness=1e7,h.frictionRelaxation=3,h.surfaceVelocity=0,this.car.body.setCollisionGroup(e),this.car.body.collides([e,s]),this.track1.body.setCollisionGroup(s),this.track1.body.collides(e,this.hitTrack,this),this.cursors=this.game.input.keyboard.createCursorKeys(),this.game.input.onDown.add(this.click,this)},update:function(){if(this.currentSpeed>250?(this.baseSpeed=.25,this.steeringMultiplier=this.cursors.up.isDown?1:2):this.currentSpeed>200?(this.baseSpeed=.5,this.steeringMultiplier=this.cursors.up.isDown?1.5:2):this.currentSpeed>150?(this.baseSpeed=.75,this.steeringMultiplier=this.cursors.up.isDown?1.5:2):(this.baseSpeed=1,this.steeringMultiplier=2),this.cursors.left.isDown?this.currentSpeed>0?this.steeringAngle=this.steeringAngle>0?this.steeringAngle-this.steeringMultiplier:359:this.currentSpeed<0&&(this.steeringAngle=this.steeringAngle<359?this.steeringAngle+this.steeringMultiplier:0):this.cursors.right.isDown&&(this.currentSpeed>0?this.steeringAngle=this.steeringAngle<359?this.steeringAngle+this.steeringMultiplier:0:this.currentSpeed<0&&(this.steeringAngle=this.steeringAngle>0?this.steeringAngle-this.steeringMultiplier:359)),this.cursors.left.isDown||this.cursors.right.isDown){var t=this.steeringAngle-270;0>t&&(t+=360);var i=Math.floor(34*t/360);i>16?(this.car.scale.x=-1,i=32-i):(this.car.scale.x=1,t>90&&16===i&&(i=16)),this.car.frame=i}this.cursors.up.isDown?(this.currentSpeed<300&&(this.currentSpeed+=this.baseSpeed),this.backwardSpeed<0&&(this.backwardSpeed+=this.baseSpeed),this.currentSpeed>250&&this.skiddingSpeed<100&&(this.skiddingSpeed+=1),this.drifting&&(this.reduceSpeed&&(this.currentSpeed*=.75,this.reduceSpeed=!1),this.currentSpeed>=0?this.velocityFromAngle(this.steeringAngle,this.currentSpeed,this.car.body.velocity):this.velocityFromAngle(this.steeringAngle,this.backwardSpeed,this.car.body.velocity))):this.cursors.down.isDown?this.currentSpeed>-100?this.currentSpeed-=4:this.backwardSpeed>-100&&(this.backwardSpeed-=4):this.currentSpeed>2?(this.currentSpeed-=2,this.backwardSpeed-=2):this.currentSpeed<-2?(this.currentSpeed+=2,this.backwardSpeed+=2):(this.currentSpeed=0,this.backwardSpeed=0),this.cursors.up.isDown||(this.skiddingSpeed>0&&(this.skiddingSpeed-=1),this.drifting&&(this.reduceSpeed=!0)),this.skiddingSpeed?this.drifting||(this.drifting=!0):(this.currentSpeed>=0?this.velocityFromAngle(this.steeringAngle,this.currentSpeed,this.car.body.velocity):this.velocityFromAngle(this.steeringAngle,this.backwardSpeed,this.car.body.velocity),this.drifting=!1)},onInputDown:function(){this.game.state.start("menu")}},window["drift-runners"]=window["drift-runners"]||{},window["drift-runners"].Game=t}(),function(){"use strict";function t(){this.titleTxt=null,this.startTxt=null,this.sessionTxt=null,this.rectWidth=100,this.rectHeight=50,this.padding=5,this.max=4,this.inputValue=[],this.count=0}t.prototype={init:function(){},preload:function(){},create:function(){var t=this.game.width/2,i=this.game.height/2,e=this.game.add.graphics(0,0);e.beginFill(16777215,1),e.drawRect(t-this.rectWidth/2,i-this.rectHeight/2,this.rectWidth,this.rectHeight),this.titleTxt=this.add.bitmapText(t,i,"minecraftia","Input Session Number:"),this.titleTxt.align="center",this.titleTxt.x=t-this.titleTxt.textWidth/2,this.titleTxt.y=i-this.rectHeight-this.titleTxt.textHeight-this.padding,this.startTxt=this.add.bitmapText(t,i,"minecraftia","Next"),this.startTxt.align="center",this.startTxt.x=t-this.startTxt.textWidth/2,this.startTxt.y=i+this.rectHeight+this.padding,this.sessionTxt=this.add.bitmapText(t,i,"minecraftia","0000"),this.sessionTxt.align="center",this.sessionTxt.tint=16777215,this.sessionTxt.x=t-this.sessionTxt.textWidth/2,this.sessionTxt.y=i-this.sessionTxt.textHeight/2,this.game.input.keyboard.addCallbacks(this,null,null,this.keyPress),this.startTxt.inputEnabled=!0,this.startTxt.events.onInputDown.add(this.onDown,this)},update:function(){},onDown:function(){this.game.session=this.sessionToString(),this.game.state.start("control")},sessionToString:function(){var t="",i=0;for(i=this.inputValue.length;i<this.max;i++)t+="0";for(i=0;i<this.inputValue.length;i++)t+=this.inputValue[i];return t},keyPress:function(t){var i=/[0-9]/;t.search(i)>=0?(this.inputValue[this.count%this.max]=t,this.count++):console.log(t),this.sessionTxt.setText(this.sessionToString())}},window["drift-runners"]=window["drift-runners"]||{},window["drift-runners"].Lobby=t}(),window.onload=function(){"use strict";var t,i=window["drift-runners"];t=new Phaser.Game(960,540,Phaser.AUTO,"drift-runners-game"),t.state.add("boot",i.Boot),t.state.add("preloader",i.Preloader),t.state.add("menu",i.Menu),t.state.add("lobby",i.Lobby),t.state.add("room",i.Room),t.state.add("game",i.Game),t.state.add("control",i.Control),t.state.start("boot")},function(){"use strict";function t(){this.titleTxt=null,this.startTxt=null}t.prototype={create:function(){var t=this.game.width/2,i=this.game.height/2;this.titleTxt=this.add.bitmapText(t,i,"minecraftia","Example Game"),this.titleTxt.align="center",this.titleTxt.x=t-this.titleTxt.textWidth/2,i=i+this.titleTxt.height+5,this.startTxt=this.add.bitmapText(t,i,"minecraftia","START"),this.startTxt.align="center",this.startTxt.x=t-this.startTxt.textWidth/2,this.input.onDown.add(this.onDown,this),this.game.session=Math.floor(9999*Math.random()+0)},update:function(){},onDown:function(){this.game.state.start(this.game.device.desktop?"room":"lobby")}},window["drift-runners"]=window["drift-runners"]||{},window["drift-runners"].Menu=t}(),function(){"use strict";function t(){this.asset=null,this.ready=!1}t.prototype={preload:function(){this.asset=this.add.sprite(.5*this.game.width-110,.5*this.game.height-10,"preloader"),this.load.onLoadComplete.addOnce(this.onLoadComplete,this),this.load.setPreloadSprite(this.asset),this.loadResources()},loadResources:function(){this.load.image("player","assets/player.png"),this.load.bitmapFont("minecraftia","assets/minecraftia.png","assets/minecraftia.xml"),this.load.atlas("cars","assets/car_spritesheet.png","assets/car_spritesheet.json"),this.load.image("track1","assets/track1.png"),this.load.physics("physicsData","assets/physicsData.json")},create:function(){this.asset.cropEnabled=!1},update:function(){this.ready&&this.game.state.start("menu")},onLoadComplete:function(){this.ready=!0}},window["drift-runners"]=window["drift-runners"]||{},window["drift-runners"].Preloader=t}(),function(){"use strict";function t(){this.titleTxt=null,this.startTxt=null,this.playerTitle=null,this.playerTxt=[],this.playerList=[],this.maxPlayer=4,this.rectWidth=50,this.color=[16776960,65280,16711680,255]}t.prototype={preload:function(){},create:function(){var t=0,i=0;for(this.titleTxt=this.add.bitmapText(0,0,"minecraftia","Room "+this.game.session),this.titleTxt.align="center",this.titleTxt.x=this.titleTxt.textWidth/2,this.titleTxt.y=this.titleTxt.textHeight/2,this.playerTitle=this.add.bitmapText(0,0,"minecraftia","Game Players:"),this.titleTxt.align="left",this.playerTitle.x=this.titleTxt.textWidth/2,this.playerTitle.y=this.titleTxt.y+this.titleTxt.textHeight+this.playerTitle.textHeight/2,this.startTxt=this.add.bitmapText(0,0,"minecraftia","Start Game"),this.titleTxt.align="right",this.startTxt.x=this.game.width-this.startTxt.textWidth,this.startTxt.y=this.game.height-this.startTxt.textHeight,this.startTxt.inputEnabled=!0,this.startTxt.events.onInputDown.add(this.onStartButtonDown,this),t=this.playerTitle.textHeight,i=0;i<this.maxPlayer;i++)this.playerTxt.push(this.add.bitmapText(0,0,"minecraftia","Player "+i)),this.titleTxt.align="left",this.playerTxt[i].tint=this.color[i],this.playerTxt[i].x=this.titleTxt.textWidth/2,this.playerTxt[i].y=this.playerTitle.y+5+this.playerTitle.textHeight*(i+1);this.updatePlayers()},updatePlayers:function(){var t=0;for(t=0;t<this.playerList.length;t++)this.playerTxt[t].setText("Player "+t);for(t=t;t<this.maxPlayer;t++)this.playerTxt[t].setText(" ")},onStartButtonDown:function(){this.game.state.start("game")}},window["drift-runners"]=window["drift-runners"]||{},window["drift-runners"].Room=t}();